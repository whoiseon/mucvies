{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hwang-inseon/Desktop/portfolio/movie-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/hwang-inseon/Desktop/portfolio/movie-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/hwang-inseon/Desktop/portfolio/movie-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{memo,useState,useCallback,useEffect}from\"react\";import SearchIcon from\"@mui/icons-material/Search\";import axios from\"axios\";import{useRecoilState,useRecoilValue}from\"recoil\";import{useQuery}from\"react-query\";import{Header,InputWrapper,SearchButtonWrapper,SearchFormWrapper,SearchOptionWrapper}from\"../../routes/Search/styles\";import{searchKeywordState}from\"../../states/searchKeywordState\";import OptionButton from\"../OptionButton\";import{genreListState,countryListState,genreState,countryState}from\"../../states/optionListState\";import ErrorBubble from\"../ErrorBubble\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SearchForm=function SearchForm(_ref){var setMovies=_ref.setMovies,setKeyword=_ref.setKeyword,setIsLoading=_ref.setIsLoading;var genreList=useRecoilValue(genreListState);var countryList=useRecoilValue(countryListState);var _useRecoilState=useRecoilState(searchKeywordState),_useRecoilState2=_slicedToArray(_useRecoilState,2),value=_useRecoilState2[0],setValue=_useRecoilState2[1];var _useRecoilState3=useRecoilState(genreState),_useRecoilState4=_slicedToArray(_useRecoilState3,2),genre=_useRecoilState4[0],setGenre=_useRecoilState4[1];var _useRecoilState5=useRecoilState(countryState),_useRecoilState6=_slicedToArray(_useRecoilState5,2),country=_useRecoilState6[0],setCountry=_useRecoilState6[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),errorBubble=_useState2[0],setErrorBubble=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),focus=_useState4[0],setFocus=_useState4[1];var getSearchResult=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/search',{params:{query:value,genre:genre,country:country}});case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})),[value,genre,country]);var onSubmitSearch=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var _yield$axios$get2,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();setIsLoading(true);_context2.prev=2;if(!(value==='')){_context2.next=10;break;}setMovies([]);setValue('');setErrorBubble(true);setTimeout(function(){setErrorBubble(false);},3000);_context2.next=17;break;case 10:_context2.next=12;return axios.get('/api/search',{params:{query:value,genre:genre,country:country}});case 12:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;setIsLoading(false);setKeyword(value);setMovies(data);case 17:_context2.next=23;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](2);setIsLoading(false);console.error(_context2.t0);case 23:case\"end\":return _context2.stop();}}},_callee2,null,[[2,19]]);}));return function(_x){return _ref3.apply(this,arguments);};}(),[value,genre,country]);var onChangeValue=useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setFocus(true);setValue(e.target.value);case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref4.apply(this,arguments);};}(),[]);return/*#__PURE__*/_jsxs(SearchFormWrapper,{onSubmit:onSubmitSearch,children:[/*#__PURE__*/_jsx(Header,{children:\"\\uC601\\uD654 \\uAC80\\uC0C9\"}),/*#__PURE__*/_jsxs(InputWrapper,{focus:focus,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:onChangeValue,placeholder:\"\\uD0A4\\uC6CC\\uB4DC\"}),/*#__PURE__*/_jsx(SearchIcon,{}),errorBubble&&/*#__PURE__*/_jsx(ErrorBubble,{content:\"\\uAC80\\uC0C9 \\uD0A4\\uC6CC\\uB4DC\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694\"})]}),/*#__PURE__*/_jsxs(SearchOptionWrapper,{children:[/*#__PURE__*/_jsx(OptionButton,{title:\"\\uC7A5\\uB974\",data:genreList,setState:setGenre}),/*#__PURE__*/_jsx(OptionButton,{title:\"\\uAD6D\\uAC00\",data:countryList,setState:setCountry})]}),/*#__PURE__*/_jsx(SearchButtonWrapper,{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\uAC80\\uC0C9\"})})]});};export default/*#__PURE__*/memo(SearchForm);","map":{"version":3,"names":["memo","useState","useCallback","useEffect","SearchIcon","axios","useRecoilState","useRecoilValue","useQuery","Header","InputWrapper","SearchButtonWrapper","SearchFormWrapper","SearchOptionWrapper","searchKeywordState","OptionButton","genreListState","countryListState","genreState","countryState","ErrorBubble","SearchForm","setMovies","setKeyword","setIsLoading","genreList","countryList","value","setValue","genre","setGenre","country","setCountry","errorBubble","setErrorBubble","focus","setFocus","getSearchResult","get","params","query","data","onSubmitSearch","e","preventDefault","setTimeout","console","error","onChangeValue","target"],"sources":["/Users/hwang-inseon/Desktop/portfolio/movie-app/client/src/components/SearchForm/index.jsx"],"sourcesContent":["import {memo, useState, useCallback, useEffect} from \"react\";\nimport SearchIcon from \"@mui/icons-material/Search\";\nimport axios from \"axios\";\nimport {useRecoilState, useRecoilValue} from \"recoil\";\nimport {useQuery} from \"react-query\";\nimport {\n  Header,\n  InputWrapper,\n  SearchButtonWrapper,\n  SearchFormWrapper,\n  SearchOptionWrapper,\n} from \"../../routes/Search/styles\";\nimport {searchKeywordState} from \"../../states/searchKeywordState\";\nimport OptionButton from \"../OptionButton\";\nimport {genreListState, countryListState, genreState, countryState} from \"../../states/optionListState\";\nimport ErrorBubble from \"../ErrorBubble\";\n\nconst SearchForm = ({ setMovies, setKeyword, setIsLoading }) => {\n  const genreList = useRecoilValue(genreListState);\n  const countryList = useRecoilValue(countryListState);\n\n  const [value, setValue] = useRecoilState(searchKeywordState);\n  const [genre, setGenre] = useRecoilState(genreState);\n  const [country, setCountry] = useRecoilState(countryState);\n\n  const [errorBubble, setErrorBubble] = useState(false);\n\n  const [focus, setFocus] = useState(false);\n\n  const getSearchResult = useCallback(async () => {\n    const { data } = await axios.get('/api/search', {\n      params: {\n        query: value,\n        genre,\n        country,\n      },\n    });\n\n    return data;\n  }, [value, genre, country]);\n\n  const onSubmitSearch = useCallback(async (e) => {\n    e.preventDefault();\n    setIsLoading(true);\n    try {\n      if (value === '') {\n        setMovies([]);\n        setValue('');\n        setErrorBubble(true);\n        setTimeout(() => {\n          setErrorBubble(false);\n        }, 3000);\n      } else {\n        const { data } = await axios.get('/api/search', {\n          params: {\n            query: value,\n            genre,\n            country,\n          },\n        });\n        setIsLoading(false);\n        setKeyword(value);\n        setMovies(data);\n      }\n    } catch (error) {\n      setIsLoading(false);\n      console.error(error);\n    }\n  }, [value, genre, country]);\n\n  const onChangeValue = useCallback(async (e) => {\n    setFocus(true);\n    setValue(e.target.value);\n  }, []);\n\n  return (\n    <SearchFormWrapper onSubmit={onSubmitSearch}>\n      <Header>\n        영화 검색\n      </Header>\n      <InputWrapper focus={focus}>\n        <input\n          type=\"text\"\n          onChange={onChangeValue}\n          placeholder=\"키워드\"\n        />\n        <SearchIcon />\n        { errorBubble && <ErrorBubble content=\"검색 키워드를 입력해주세요\" /> }\n      </InputWrapper>\n      <SearchOptionWrapper>\n        <OptionButton title=\"장르\" data={genreList} setState={setGenre} />\n        <OptionButton title=\"국가\" data={countryList} setState={setCountry} />\n      </SearchOptionWrapper>\n      <SearchButtonWrapper>\n        <button type=\"submit\">\n          검색\n        </button>\n      </SearchButtonWrapper>\n    </SearchFormWrapper>\n  );\n};\n\nexport default memo(SearchForm);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}